{% extends "base.html" %}
{% block content %}

<!-- üî• GARANTE QUE "form" SEMPRE EXISTA -->
{% set form = form if form is defined else {} %}

<div class="page-head">
  <h1>Publicar no Ip√™</h1>
  <p class="muted">Formato guiado para for√ßar simplifica√ß√£o (o ‚Äútradutor mental‚Äù).</p>
</div>

{% if erro %}
  <div class="flash error">{{ erro }}</div>
{% endif %}

<form class="form card" method="POST">

  <div class="two">
    <div>
      <label>Seu nome</label>
      <input 
        name="pesquisador"
        value="{{ form.get('pesquisador','') }}"
        placeholder="Ex: Sabrina Andrade Rocha"
        required>
    </div>

    <div>
      <label>Institui√ß√£o (opcional)</label>
      <input 
        name="instituicao"
        value="{{ form.get('instituicao','') }}"
        placeholder="Ex: UFU">
    </div>
  </div>


  <div class="two">
    <div>
      <label>Selecione a Grande √Årea</label>

      <select name="area" required>
        <option value="" disabled {{ 'selected' if not form.get('area') }}>
          Selecione a Grande √Årea
        </option>

        {% for a in areas %}
          <option value="{{ a }}" {{ 'selected' if form.get('area') == a }}>
            {{ a }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div>
      <label>N√≠vel de evid√™ncia</label>

      <select name="evidencia">
        {% for e in evidencias %}
          <option value="{{ e }}" {{ 'selected' if form.get('evidencia','Inicial') == e }}>
            {{ e }}
          </option>
        {% endfor %}
      </select>
    </div>
  </div>


  <label>T√≠tulo</label>
  <input 
    name="titulo"
    value="{{ form.get('titulo','') }}"
    placeholder="T√≠tulo da pesquisa"
    required>


  <div class="two">
    <div>
      <label>Ano (opcional)</label>
      <input 
        name="ano"
        value="{{ form.get('ano','') }}"
        inputmode="numeric"
        placeholder="Ex: 2026">
    </div>

    <div>
      <label>Tags (opcional)</label>
      <input 
        name="tags"
        value="{{ form.get('tags','') }}"
        placeholder="Ex: ansiedade; adolesc√™ncia; SUS">
    </div>
  </div>


  <label>Descoberta principal (obrigat√≥rio)</label>
  <textarea 
    name="descoberta"
    rows="4"
    placeholder="Imagine que est√° explicando para um amigo no bar: O que voc√™ descobriu?"
    required>{{ form.get('descoberta','') }}</textarea>


  <label>Por que a sociedade deveria se importar com isso agora? (opcional)</label>
  <textarea 
    name="importancia"
    rows="4"
    placeholder="Por que isso importa hoje?">{{ form.get('importancia','') }}</textarea>


  <label>Aplica√ß√£o pr√°tica (opcional)</label>
  <textarea 
    name="aplicacao"
    rows="4"
    placeholder="O que muda na pr√°tica?">{{ form.get('aplicacao','') }}</textarea>


  <label>Quem deveria saber disso? (opcional)</label>
  <input 
    name="publico"
    value="{{ form.get('publico','') }}"
    placeholder="Ex: profissionais, gestores, professores, legisladores...">


  <label>Link do artigo original ou DOI (Valida√ß√£o Cient√≠fica)</label>
  <input 
    name="link_original"
    value="{{ form.get('link_original','') }}"
    placeholder="Ex: https://doi.org/..."
    required>


  <label>URL de uma imagem ilustrativa (Opcional)</label>
  <input 
    name="imagem_url"
    value="{{ form.get('imagem_url','') }}"
    placeholder="Cole a URL de uma imagem (opcional)">


  <label>C√≥digo de Convite (Pe√ßa ao admin)</label>
  <input 
    name="codigo_convite"
    value="{{ form.get('codigo_convite','') }}"
    placeholder="C√≥digo de Convite"
    required
    class="invite">


  <div class="actions">
    <button class="btn" type="submit">Publicar</button>
    <a class="btn ghost" href="{{ url_for('index') }}">Cancelar</a>
  </div>

</form>

{% endblock %}
